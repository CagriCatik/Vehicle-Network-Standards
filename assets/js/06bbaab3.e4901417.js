"use strict";(self.webpackChunkvns=self.webpackChunkvns||[]).push([[19710],{53675:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>c,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"DoIP/benutzung_doip_diagnose/typische-diagnosesequenz","title":"Typische Diagnosesequenz","description":"Die typische Diagnosesequenz beschreibt den Ablauf einer Kommunikation zwischen einem Diagnosetester und einem Fahrzeugsteuerger\xe4t (ECU) im Rahmen von DoIP (Diagnostics over Internet Protocol). Diese Sequenz stellt sicher, dass Diagnoseanfragen zuverl\xe4ssig verarbeitet und Antworten korrekt \xfcbermittelt werden.","source":"@site/docs/DoIP/04_benutzung_doip_diagnose/02_typische-diagnosesequenz.md","sourceDirName":"DoIP/04_benutzung_doip_diagnose","slug":"/DoIP/benutzung_doip_diagnose/typische-diagnosesequenz","permalink":"/Vehicle-Network-Standards/docs/DoIP/benutzung_doip_diagnose/typische-diagnosesequenz","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DoIP/04_benutzung_doip_diagnose/02_typische-diagnosesequenz.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"doipSidebar","previous":{"title":"Diagnoseanfrage und -antwort","permalink":"/Vehicle-Network-Standards/docs/DoIP/benutzung_doip_diagnose/diagnoseanfrage-antwort"},"next":{"title":"DoIP Message","permalink":"/Vehicle-Network-Standards/docs/category/doip-message"}}');var t=i(74848),s=i(28453);const a={},d="Typische Diagnosesequenz",l={},o=[{value:"Ablauf der Diagnosesequenz",id:"ablauf-der-diagnosesequenz",level:2},{value:"Schritt 1: Diagnoseanfrage",id:"schritt-1-diagnoseanfrage",level:3},{value:"Details der Anfrage:",id:"details-der-anfrage",level:4},{value:"Erkl\xe4rung:",id:"erkl\xe4rung",level:4},{value:"Schritt 2: DoIP-Best\xe4tigung (DoIP Ack)",id:"schritt-2-doip-best\xe4tigung-doip-ack",level:3},{value:"Ablauf:",id:"ablauf",level:4},{value:"Bedeutung:",id:"bedeutung",level:4},{value:"Schritt 3: Diagnose-Response",id:"schritt-3-diagnose-response",level:3},{value:"Details der Antwort:",id:"details-der-antwort",level:4},{value:"Erkl\xe4rung:",id:"erkl\xe4rung-1",level:4},{value:"Schritt 4: Empfang der Antwort",id:"schritt-4-empfang-der-antwort",level:3},{value:"P6-Timeout:",id:"p6-timeout",level:4},{value:"Bedeutung:",id:"bedeutung-1",level:4},{value:"Ablaufdiagramm der Diagnosesequenz",id:"ablaufdiagramm-der-diagnosesequenz",level:2},{value:"Relevante Codebeispiele",id:"relevante-codebeispiele",level:2},{value:"Beispiel: Senden einer Diagnoseanfrage",id:"beispiel-senden-einer-diagnoseanfrage",level:3},{value:"Beispiel: Validierung des P6-Timeouts",id:"beispiel-validierung-des-p6-timeouts",level:3},{value:"H\xe4ufige Probleme und L\xf6sungen",id:"h\xe4ufige-probleme-und-l\xf6sungen",level:2},{value:"Problem 1: Keine Antwort innerhalb des P6-Timeouts",id:"problem-1-keine-antwort-innerhalb-des-p6-timeouts",level:3},{value:"Problem 2: DoIP-Best\xe4tigung fehlt",id:"problem-2-doip-best\xe4tigung-fehlt",level:3},{value:"Problem 3: Fehlerhafte Daten in der Antwort",id:"problem-3-fehlerhafte-daten-in-der-antwort",level:3}];function g(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"typische-diagnosesequenz",children:"Typische Diagnosesequenz"})}),"\n",(0,t.jsxs)(n.p,{children:["Die ",(0,t.jsx)(n.strong,{children:"typische Diagnosesequenz"})," beschreibt den Ablauf einer Kommunikation zwischen einem Diagnosetester und einem Fahrzeugsteuerger\xe4t (ECU) im Rahmen von DoIP (Diagnostics over Internet Protocol). Diese Sequenz stellt sicher, dass Diagnoseanfragen zuverl\xe4ssig verarbeitet und Antworten korrekt \xfcbermittelt werden."]}),"\n",(0,t.jsx)(n.h2,{id:"ablauf-der-diagnosesequenz",children:"Ablauf der Diagnosesequenz"}),"\n",(0,t.jsx)(n.p,{children:"Die Diagnosesequenz umfasst vier Hauptschritte:"}),"\n",(0,t.jsx)(n.h3,{id:"schritt-1-diagnoseanfrage",children:"Schritt 1: Diagnoseanfrage"}),"\n",(0,t.jsx)(n.p,{children:"Der Tester initiiert eine Diagnoseanfrage und sendet sie \xfcber TCP an das Gateway. Die Anfrage wird im UDS-Format (Unified Diagnostic Services) formuliert und enth\xe4lt die folgenden Informationen:"}),"\n",(0,t.jsx)(n.h4,{id:"details-der-anfrage",children:"Details der Anfrage:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logische Adresse des Testers"}),": ",(0,t.jsx)(n.code,{children:"0x203"}),(0,t.jsx)(n.br,{}),"\n","\u2192 Identifiziert den Diagnosetester."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logische Adresse der ECU"}),": ",(0,t.jsx)(n.code,{children:"0x205"}),(0,t.jsx)(n.br,{}),"\n","\u2192 Gibt die Ziel-ECU an."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"UDS-Service"}),": ",(0,t.jsx)(n.code,{children:"ReadDataByIdentifier (SID: 0x22)"}),(0,t.jsx)(n.br,{}),"\n","\u2192 Fordert spezifische Daten von der ECU an, wie z. B. Sensordaten oder Fahrzeugstatusinformationen."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"Tester \u2192 Gateway:\nDiagnoseanfrage\n"})}),"\n",(0,t.jsx)(n.h4,{id:"erkl\xe4rung",children:"Erkl\xe4rung:"}),"\n",(0,t.jsx)(n.p,{children:"Der Tester fordert bestimmte Daten von der ECU an, indem er die logische Adresse und den UDS-Service in der Nachricht spezifiziert. Diese Anfrage wird vom Gateway weitergeleitet."}),"\n",(0,t.jsx)(n.h3,{id:"schritt-2-doip-best\xe4tigung-doip-ack",children:"Schritt 2: DoIP-Best\xe4tigung (DoIP Ack)"}),"\n",(0,t.jsx)(n.p,{children:"Das Gateway best\xe4tigt den Empfang der Diagnoseanfrage und leitet diese an die Ziel-ECU weiter. Die Best\xe4tigung (DoIP Ack) enth\xe4lt keine Diagnosedaten, sondern dient lediglich der Kommunikation, dass die Anfrage erfolgreich empfangen wurde."}),"\n",(0,t.jsx)(n.h4,{id:"ablauf",children:"Ablauf:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Das Gateway \xfcberpr\xfcft die Anfrage und leitet sie an die Ziel-ECU weiter."}),"\n",(0,t.jsx)(n.li,{children:"Eine Best\xe4tigungsnachricht wird an den Tester zur\xfcckgesendet."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"Gateway \u2192 Tester:\nDoIP-Best\xe4tigung (DoIP Ack)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"bedeutung",children:"Bedeutung:"}),"\n",(0,t.jsx)(n.p,{children:"Die Best\xe4tigung zeigt an, dass die Anfrage korrekt verarbeitet wird und das Gateway mit der Ziel-ECU kommuniziert."}),"\n",(0,t.jsx)(n.h3,{id:"schritt-3-diagnose-response",children:"Schritt 3: Diagnose-Response"}),"\n",(0,t.jsx)(n.p,{children:"Die Ziel-ECU verarbeitet die Diagnoseanfrage und generiert eine Antwort. Diese Antwort wird \xfcber das Gateway an den Tester zur\xfcckgeleitet."}),"\n",(0,t.jsx)(n.h4,{id:"details-der-antwort",children:"Details der Antwort:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logische Adresse des Testers"}),": ",(0,t.jsx)(n.code,{children:"0x203"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logische Adresse der ECU"}),": ",(0,t.jsx)(n.code,{children:"0x205"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"UDS-Service"}),": ",(0,t.jsx)(n.code,{children:"ReadDataByIdentifier (SID: 0x22)"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"UDS-Daten"}),": Die angeforderten Daten (z. B. Fahrzeugstatus oder Sensordaten)."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"Gateway \u2192 Tester:\nDiagnose-Response\n"})}),"\n",(0,t.jsx)(n.h4,{id:"erkl\xe4rung-1",children:"Erkl\xe4rung:"}),"\n",(0,t.jsx)(n.p,{children:"Die Antwort enth\xe4lt die vom Tester angeforderten Daten oder Statusinformationen und wird innerhalb des festgelegten UDS-Timeouts (P6) zur\xfcckgesendet."}),"\n",(0,t.jsx)(n.h3,{id:"schritt-4-empfang-der-antwort",children:"Schritt 4: Empfang der Antwort"}),"\n",(0,t.jsx)(n.p,{children:"Der Diagnosetester erwartet die Antwort vor Ablauf des P6-Intervalls. Dieses Intervall ist ein UDS-spezifischer Timeout f\xfcr die Kommunikation mit der Ziel-ECU."}),"\n",(0,t.jsx)(n.h4,{id:"p6-timeout",children:"P6-Timeout:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Definition"}),": Zeitrahmen, in dem die ECU die Antwort bereitstellen muss."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Typischer Wert"}),": Standardm\xe4\xdfig zwischen 50 ms und 500 ms, je nach Konfiguration."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"Tester \u2192 Empfang der Antwort innerhalb von P6\n"})}),"\n",(0,t.jsx)(n.h4,{id:"bedeutung-1",children:"Bedeutung:"}),"\n",(0,t.jsx)(n.p,{children:"Das P6-Timeout stellt sicher, dass die Kommunikation in einem vordefinierten Zeitrahmen erfolgt und bei Verz\xf6gerungen Fehler gemeldet werden."}),"\n",(0,t.jsx)(n.h2,{id:"ablaufdiagramm-der-diagnosesequenz",children:"Ablaufdiagramm der Diagnosesequenz"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Diagnoseanfrage"}),": Der Tester sendet die Anfrage \xfcber TCP an das Gateway."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DoIP-Best\xe4tigung"}),": Das Gateway best\xe4tigt den Empfang und leitet die Anfrage weiter."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Diagnose-Response"}),": Die ECU verarbeitet die Anfrage und antwortet \xfcber das Gateway."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Empfang der Antwort"}),": Der Tester erh\xe4lt die Antwort innerhalb des festgelegten Zeitrahmens (P6)."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"relevante-codebeispiele",children:"Relevante Codebeispiele"}),"\n",(0,t.jsx)(n.h3,{id:"beispiel-senden-einer-diagnoseanfrage",children:"Beispiel: Senden einer Diagnoseanfrage"}),"\n",(0,t.jsx)(n.p,{children:"Das folgende Python-Skript zeigt, wie eine Diagnoseanfrage an ein Gateway gesendet wird:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import socket\n\n# Verbindungsparameter\ntester_ip = "192.168.1.1"\ngateway_ip = "192.168.1.2"\ntester_port = 18945  # Zuf\xe4llig generierter Port\ngateway_port = 13400  # Zielport f\xfcr DoIP\n\n# Diagnoseanfrage erstellen (UDS: ReadDataByIdentifier, SID: 0x22, DID: 0x1234)\ndiagnostic_request = bytearray([0x22, 0x12, 0x34])\n\n# Verbindung herstellen und Anfrage senden\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.connect((gateway_ip, gateway_port))\n    s.send(diagnostic_request)\n    response = s.recv(1024)\n\nprint("Diagnoseantwort erhalten:", response.hex())\n'})}),"\n",(0,t.jsx)(n.h3,{id:"beispiel-validierung-des-p6-timeouts",children:"Beispiel: Validierung des P6-Timeouts"}),"\n",(0,t.jsx)(n.p,{children:"Dieses Skript \xfcberpr\xfcft, ob die Antwort innerhalb des P6-Timeouts empfangen wurde:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import time\n\n# Maximales P6-Timeout (in Sekunden)\nP6_TIMEOUT = 0.5\n\n# Startzeit\nstart_time = time.time()\n\n# Warten auf Antwort\ntry:\n    response = s.recv(1024)\n    elapsed_time = time.time() - start_time\n    if elapsed_time > P6_TIMEOUT:\n        print("P6-Timeout \xfcberschritten!")\n    else:\n        print("Antwort erhalten innerhalb:", elapsed_time, "Sekunden")\nexcept socket.timeout:\n    print("Keine Antwort innerhalb des P6-Timeouts.")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"h\xe4ufige-probleme-und-l\xf6sungen",children:"H\xe4ufige Probleme und L\xf6sungen"}),"\n",(0,t.jsx)(n.h3,{id:"problem-1-keine-antwort-innerhalb-des-p6-timeouts",children:"Problem 1: Keine Antwort innerhalb des P6-Timeouts"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Ursache"}),": Die ECU ben\xf6tigt zu lange f\xfcr die Verarbeitung."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"L\xf6sung"}),": Pr\xfcfen Sie die ECU-Konfiguration und erh\xf6hen Sie ggf. den P6-Wert."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-2-doip-best\xe4tigung-fehlt",children:"Problem 2: DoIP-Best\xe4tigung fehlt"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Ursache"}),": Netzwerkprobleme oder fehlerhafte Gateway-Konfiguration."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"L\xf6sung"}),": Stellen Sie sicher, dass das Gateway erreichbar ist und korrekt konfiguriert wurde."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"problem-3-fehlerhafte-daten-in-der-antwort",children:"Problem 3: Fehlerhafte Daten in der Antwort"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Ursache"}),": Die Anfrage enthielt falsche Parameter (z. B. ung\xfcltiger DID)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"L\xf6sung"}),": \xdcberpr\xfcfen Sie die Anfragedaten auf Richtigkeit."]}),"\n"]})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(g,{...e})}):g(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var r=i(96540);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);