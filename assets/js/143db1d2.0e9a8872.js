"use strict";(self.webpackChunkvns=self.webpackChunkvns||[]).push([[27520],{79476:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"UDS/examples/Clear-DTC-Information","title":"Examples - 0x14","description":"Here are realistic examples of how to implement Service 0x14 for clearing Diagnostic Trouble Codes (DTCs) using Python and CAPL. The examples demonstrate how to send the Clear Diagnostic Information service request, handle responses, and simulate realistic scenarios for clearing DTCs.","source":"@site/docs/UDS/04_examples/Clear-DTC-Information.md","sourceDirName":"UDS/04_examples","slug":"/UDS/examples/Clear-DTC-Information","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Clear-DTC-Information","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/UDS/04_examples/Clear-DTC-Information.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"udsSidebar","previous":{"title":"Examples - 0x23","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Read-Memory-by-Adress"},"next":{"title":"Examples - 0x23","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Write-Memory-by-Adress"}}');var r=s(74848),i=s(28453);const o={sidebar_position:7},a="Examples - 0x14",l={},c=[{value:"<strong>1. Python Example</strong>",id:"1-python-example",level:2},{value:"<strong>Dependencies:</strong>",id:"dependencies",level:3},{value:"<strong>Python Code Example:</strong>",id:"python-code-example",level:3},{value:"<strong>Explanation</strong>:",id:"explanation",level:3},{value:"<strong>Example Output</strong>:",id:"example-output",level:3},{value:"<strong>2. CAPL Example</strong>",id:"2-capl-example",level:2},{value:"<strong>CAPL Code Example:</strong>",id:"capl-code-example",level:3},{value:"<strong>Explanation</strong>:",id:"explanation-1",level:3},{value:"<strong>Example Output in CANoe (CAPL Console)</strong>:",id:"example-output-in-canoe-capl-console",level:3},{value:"<strong>3. Key Points</strong>",id:"3-key-points",level:2},{value:"<strong>4. Conclusion</strong>",id:"4-conclusion",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"examples---0x14",children:"Examples - 0x14"})}),"\n",(0,r.jsxs)(n.p,{children:["Here are realistic examples of how to implement ",(0,r.jsx)(n.strong,{children:"Service 0x14"})," for clearing Diagnostic Trouble Codes (DTCs) using ",(0,r.jsx)(n.strong,{children:"Python"})," and ",(0,r.jsx)(n.strong,{children:"CAPL"}),". The examples demonstrate how to send the ",(0,r.jsx)(n.code,{children:"Clear Diagnostic Information"})," service request, handle responses, and simulate realistic scenarios for clearing DTCs."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-python-example",children:(0,r.jsx)(n.strong,{children:"1. Python Example"})}),"\n",(0,r.jsxs)(n.p,{children:["In Python, we'll simulate a diagnostic tool that sends a request to clear DTCs using a ",(0,r.jsx)(n.strong,{children:"CAN bus"}),". The example demonstrates how you might use a library like ",(0,r.jsx)(n.code,{children:"python-can"})," to send and receive UDS messages."]}),"\n",(0,r.jsx)(n.h3,{id:"dependencies",children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"python-can"}),": A Python library for CAN bus communication."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"python-uds"}),": A UDS protocol implementation (this can be installed via ",(0,r.jsx)(n.code,{children:"pip install python-uds"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install python-can python-uds\n"})}),"\n",(0,r.jsx)(n.h3,{id:"python-code-example",children:(0,r.jsx)(n.strong,{children:"Python Code Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import can\nfrom uds import UdsClient, ServiceIdentifier, DiagnosticSessionControl\n\n# Setup CAN bus channel\nbus = can.interface.Bus(channel=\'can0\', bustype=\'socketcan\')\n\n# Create a UDS Client\nuds_client = UdsClient(bus)\n\n# Function to clear DTCs (Service 0x14)\ndef clear_dtc(dtc_list):\n    """\n    Sends a Clear Diagnostic Information request to clear DTCs.\n    """\n    # Construct the request message for Service 0x14 with DTCs\n    request_data = [0x0x14] + dtc_list  # 0x0x14 is the Service ID for Clear Diagnostic Information\n    \n    try:\n        # Send the request message\n        uds_client.send_request(ServiceIdentifier.CLEAR_DIAGNOSTIC_INFORMATION, request_data)\n        \n        # Wait for the response (positive or negative)\n        response = uds_client.receive_response(timeout=1)\n        \n        if response and response[0] == 0x54:\n            print("Successfully cleared DTCs:", dtc_list)\n        else:\n            print("Error: Could not clear DTCs. Response:", response)\n    \n    except Exception as e:\n        print(f"An error occurred: {e}")\n\n# Example of clearing DTCs A1 B2 C3\ndtcs_to_clear = [0xA1, 0xB2, 0xC3]\nclear_dtc(dtcs_to_clear)\n\n# Example of clearing all DTCs using FF FF FF (optional, for all stored codes)\nclear_dtc([0xFF, 0xFF, 0xFF])\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"explanation",children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Identifier 0x0x14"}),": The first byte of the request message is the service ID for ",(0,r.jsx)(n.strong,{children:"Clear Diagnostic Information"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DTC List"}),": The diagnostic trouble codes that need to be cleared. This could be a specific code or ",(0,r.jsx)(n.code,{children:"0xFF"})," to indicate clearing all DTCs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Response Handling"}),": After sending the request, the tool waits for a response. A positive response (",(0,r.jsx)(n.code,{children:"0x54"}),") indicates successful clearing of DTCs. If the DTCs can't be cleared, a negative response is returned."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"example-output",children:[(0,r.jsx)(n.strong,{children:"Example Output"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Successfully cleared DTCs: [161, 178, 195]\nSuccessfully cleared all DTCs: [255, 255, 255]\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-capl-example",children:(0,r.jsx)(n.strong,{children:"2. CAPL Example"})}),"\n",(0,r.jsxs)(n.p,{children:["CAPL (CAN Application Programming Language) is used in tools like ",(0,r.jsx)(n.strong,{children:"Vector CANoe"})," for simulating and testing UDS services. Here's an example of how to implement ",(0,r.jsx)(n.strong,{children:"Service 0x14"})," in CAPL for clearing DTCs."]}),"\n",(0,r.jsx)(n.h3,{id:"capl-code-example",children:(0,r.jsx)(n.strong,{children:"CAPL Code Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-capl",children:'// Define the service ID for "Clear Diagnostic Information"\n#define CLEAR_DIAGNOSTIC_SERVICE 0x0x14\n\n// Define the response code for "Positive Response"\n#define POSITIVE_RESPONSE 0x54\n\n// Define a function to clear DTCs\nvoid clearDTCs(byte[] dtcList)\n{\n    // Prepare the request message\n    byte request[8];\n    request[0] = CLEAR_DIAGNOSTIC_SERVICE; // Service ID for Clear Diagnostic Information\n    \n    // Copy the DTC list into the request (ensure it doesn\'t exceed array size)\n    for (int i = 0; i < dtcList.length; i++)\n    {\n        request[i + 1] = dtcList[i];\n    }\n\n    // Send the request message\n    output(CAN_CHANNEL, request);\n    \n    // Wait for the response\n    message response = input(CAN_CHANNEL);\n    \n    // Check the response\n    if (response.data[0] == POSITIVE_RESPONSE)\n    {\n        write("DTCs successfully cleared: ");\n        for (int i = 1; i < response.data.length; i++)\n        {\n            writeHex(response.data[i]);\n        }\n    }\n    else\n    {\n        write("Failed to clear DTCs. Error code: ");\n        writeHex(response.data[0]);\n    }\n}\n\n// Main test function\non start\n{\n    // Example: Clear specific DTCs A1 B2 C3\n    byte dtcList1[] = {0xA1, 0xB2, 0xC3};\n    clearDTCs(dtcList1);\n    \n    // Example: Clear all DTCs using FF FF FF\n    byte dtcList2[] = {0xFF, 0xFF, 0xFF};\n    clearDTCs(dtcList2);\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"explanation-1",children:[(0,r.jsx)(n.strong,{children:"Explanation"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:["Service ID ",(0,r.jsx)(n.code,{children:"0x14"})]}),": The first byte in the request indicates that the message is a ",(0,r.jsx)(n.strong,{children:"Clear Diagnostic Information"})," request."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"DTC List"}),": The list of DTCs to be cleared is copied into the request message. You can send multiple DTCs or use ",(0,r.jsx)(n.code,{children:"0xFF"})," to indicate clearing all DTCs."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Response Handling"}),": After sending the request, the script waits for a response. If the first byte of the response is ",(0,r.jsx)(n.code,{children:"0x54"}),", the operation is successful, and the DTCs have been cleared. If the response is negative (e.g., ",(0,r.jsx)(n.code,{children:"0x31"}),"), an error occurred."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"example-output-in-canoe-capl-console",children:[(0,r.jsx)(n.strong,{children:"Example Output in CANoe (CAPL Console)"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"DTCs successfully cleared: A1 B2 C3\nDTCs successfully cleared: FF FF FF\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-key-points",children:(0,r.jsx)(n.strong,{children:"3. Key Points"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Request Format"}),": Both Python and CAPL examples demonstrate how to construct a request frame to send to the ECU to clear DTCs. This includes the service ID (",(0,r.jsx)(n.code,{children:"0x14"}),") and the DTCs to be cleared (or ",(0,r.jsx)(n.code,{children:"0xFF"})," to clear all)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Response Format"}),": After the request is sent, the ECU returns a response indicating whether the operation was successful (",(0,r.jsx)(n.code,{children:"0x54"}),") or if there was an error (e.g., ",(0,r.jsx)(n.code,{children:"0x31"})," for request out of range)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": It's important to handle potential errors, such as unsupported DTCs or power interruptions, by checking the response and implementing retries or logging for diagnostic purposes."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-conclusion",children:(0,r.jsx)(n.strong,{children:"4. Conclusion"})}),"\n",(0,r.jsxs)(n.p,{children:["The Python and CAPL examples demonstrate how to implement ",(0,r.jsx)(n.strong,{children:"Service 0x14 (Clear Diagnostic Information)"})," in a diagnostic tool that communicates over the ",(0,r.jsx)(n.strong,{children:"CAN bus"}),". By sending a properly formatted request with the appropriate DTCs, the diagnostic tool can clear stored DTCs in the ECU's memory. Understanding the request and response formats, as well as handling errors effectively, is crucial for maintaining accurate diagnostic information and preventing miscommunication between the diagnostic tool and the ECU."]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var t=s(96540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);