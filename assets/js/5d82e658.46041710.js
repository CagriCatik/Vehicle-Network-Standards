"use strict";(self.webpackChunkvns=self.webpackChunkvns||[]).push([[5956],{15457:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>g,frontMatter:()=>a,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"DoIP/benutzung_doip_diagnose/diagnoseanfrage-antwort","title":"Diagnoseanfrage und -antwort","description":"Die Diagnoseanfrage und -antwort ist ein zentraler Bestandteil des Kommunikationsprozesses im Rahmen von DoIP (Diagnostics over Internet Protocol). Dieser Prozess erm\xf6glicht es einem Diagnosetester, Informationen von Steuerger\xe4ten (ECUs) im Fahrzeug zu erhalten, Diagnosen durchzuf\xfchren und Fehlercodes auszulesen oder Steuerger\xe4te zu programmieren.","source":"@site/docs/DoIP/04_benutzung_doip_diagnose/01_diagnoseanfrage-antwort.md","sourceDirName":"DoIP/04_benutzung_doip_diagnose","slug":"/DoIP/benutzung_doip_diagnose/diagnoseanfrage-antwort","permalink":"/Vehicle-Network-Standards/docs/DoIP/benutzung_doip_diagnose/diagnoseanfrage-antwort","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/DoIP/04_benutzung_doip_diagnose/01_diagnoseanfrage-antwort.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"doipSidebar","previous":{"title":"Benutzung von DoIP Diagnose","permalink":"/Vehicle-Network-Standards/docs/category/benutzung-von-doip-diagnose"},"next":{"title":"Typische Diagnosesequenz","permalink":"/Vehicle-Network-Standards/docs/DoIP/benutzung_doip_diagnose/typische-diagnosesequenz"}}');var s=i(74848),t=i(28453);const a={},d="Diagnoseanfrage und -antwort",o={},l=[{value:"Ablauf einer Diagnoseanfrage und -antwort",id:"ablauf-einer-diagnoseanfrage-und--antwort",level:2},{value:"Schritt 1: Diagnoseanfrage (Diagnostic Request)",id:"schritt-1-diagnoseanfrage-diagnostic-request",level:3},{value:"Typische Parameter einer Diagnoseanfrage:",id:"typische-parameter-einer-diagnoseanfrage",level:4},{value:"Beispiel f\xfcr eine Diagnoseanfrage:",id:"beispiel-f\xfcr-eine-diagnoseanfrage",level:4},{value:"Schritt 2: Diagnoseantwort (Diagnostic Response)",id:"schritt-2-diagnoseantwort-diagnostic-response",level:3},{value:"Typische Parameter einer Diagnoseantwort:",id:"typische-parameter-einer-diagnoseantwort",level:4},{value:"Beispiel f\xfcr eine Diagnoseantwort:",id:"beispiel-f\xfcr-eine-diagnoseantwort",level:4},{value:"Typische Diagnosefunktionen",id:"typische-diagnosefunktionen",level:2},{value:"Ablaufdiagramm einer Diagnoseanfrage und -antwort",id:"ablaufdiagramm-einer-diagnoseanfrage-und--antwort",level:2},{value:"Relevante Codebeispiele",id:"relevante-codebeispiele",level:2},{value:"Beispiel 1: Senden einer Diagnoseanfrage",id:"beispiel-1-senden-einer-diagnoseanfrage",level:3},{value:"Beispiel 2: Auswerten einer Diagnoseantwort",id:"beispiel-2-auswerten-einer-diagnoseantwort",level:3},{value:"H\xe4ufige Probleme und L\xf6sungen",id:"h\xe4ufige-probleme-und-l\xf6sungen",level:2},{value:"Problem 1: Keine Antwort vom Gateway",id:"problem-1-keine-antwort-vom-gateway",level:3},{value:"Problem 2: Fehlercode in der Antwort",id:"problem-2-fehlercode-in-der-antwort",level:3},{value:"Problem 3: Zeit\xfcberschreitung",id:"problem-3-zeit\xfcberschreitung",level:3}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"diagnoseanfrage-und--antwort",children:"Diagnoseanfrage und -antwort"})}),"\n",(0,s.jsxs)(n.p,{children:["Die ",(0,s.jsx)(n.strong,{children:"Diagnoseanfrage und -antwort"})," ist ein zentraler Bestandteil des Kommunikationsprozesses im Rahmen von DoIP (Diagnostics over Internet Protocol). Dieser Prozess erm\xf6glicht es einem Diagnosetester, Informationen von Steuerger\xe4ten (ECUs) im Fahrzeug zu erhalten, Diagnosen durchzuf\xfchren und Fehlercodes auszulesen oder Steuerger\xe4te zu programmieren."]}),"\n",(0,s.jsx)(n.h2,{id:"ablauf-einer-diagnoseanfrage-und--antwort",children:"Ablauf einer Diagnoseanfrage und -antwort"}),"\n",(0,s.jsx)(n.p,{children:"Der Prozess besteht aus zwei Hauptschritten:"}),"\n",(0,s.jsx)(n.h3,{id:"schritt-1-diagnoseanfrage-diagnostic-request",children:"Schritt 1: Diagnoseanfrage (Diagnostic Request)"}),"\n",(0,s.jsx)(n.p,{children:"Der Diagnosetester sendet eine Diagnoseanfrage an das Gateway, das diese Anfrage an die entsprechenden Steuerger\xe4te (ECUs) weiterleitet. Die Anfrage enth\xe4lt spezifische Parameter, die angeben, welche Daten oder Funktionen angefordert werden."}),"\n",(0,s.jsx)(n.h4,{id:"typische-parameter-einer-diagnoseanfrage",children:"Typische Parameter einer Diagnoseanfrage:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quell-MAC-Adresse"}),": Identifiziert die Hardware des Testers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ziel-MAC-Adresse"}),": Identifiziert die Hardware des Gateways."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quell-IP-Adresse"}),": IP-Adresse des Testers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ziel-IP-Adresse"}),": IP-Adresse des Gateways."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quell-Port"}),": Zuf\xe4lliger Port, der vom Tester generiert wird."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ziel-Port"}),": Standardm\xe4\xdfig ",(0,s.jsx)(n.code,{children:"13400"})," f\xfcr DoIP."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Diagnosedaten"}),": Informationen \xfcber die angeforderten Daten oder Befehle, wie:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"SID (Service Identifier)"}),": Gibt die spezifische Diagnosefunktion an (z. B. ",(0,s.jsx)(n.code,{children:"0x22"})," f\xfcr Datenabruf)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"DID (Data Identifier)"}),": Gibt den Datensatz an, der angefordert wird."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"beispiel-f\xfcr-eine-diagnoseanfrage",children:"Beispiel f\xfcr eine Diagnoseanfrage:"}),"\n",(0,s.jsx)(n.p,{children:"Die Anfrage kann beispielsweise den aktuellen Fahrzeugstatus (z. B. Sensordaten) oder Fehlercodes aus einer ECU anfordern."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"Tester \u2192 Gateway:\nDiagnostic Request\nSID: 0x22 (Read Data by Identifier)\nDID: 0x1234 (Requested Data)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"schritt-2-diagnoseantwort-diagnostic-response",children:"Schritt 2: Diagnoseantwort (Diagnostic Response)"}),"\n",(0,s.jsx)(n.p,{children:"Das Gateway leitet die Diagnoseanfrage an die entsprechende ECU weiter. Nachdem die ECU die Anfrage verarbeitet hat, sendet sie eine Antwort zur\xfcck, die \xfcber das Gateway an den Tester weitergeleitet wird."}),"\n",(0,s.jsx)(n.h4,{id:"typische-parameter-einer-diagnoseantwort",children:"Typische Parameter einer Diagnoseantwort:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quell-MAC-Adresse"}),": Identifiziert die Hardware des Gateways."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ziel-MAC-Adresse"}),": Identifiziert die Hardware des Testers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Quell-IP-Adresse"}),": IP-Adresse des Gateways."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ziel-IP-Adresse"}),": IP-Adresse des Testers."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Diagnosedaten"}),": Die angeforderten Daten oder die Best\xe4tigung des Befehls."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"beispiel-f\xfcr-eine-diagnoseantwort",children:"Beispiel f\xfcr eine Diagnoseantwort:"}),"\n",(0,s.jsx)(n.p,{children:"Die Antwort enth\xe4lt die angeforderten Daten oder einen Statuscode, der den Erfolg oder Fehler der Anfrage anzeigt."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"Gateway \u2192 Tester:\nDiagnostic Response\nData: 0x5678 (Requested Data)\nStatus: Success\n"})}),"\n",(0,s.jsx)(n.h2,{id:"typische-diagnosefunktionen",children:"Typische Diagnosefunktionen"}),"\n",(0,s.jsx)(n.p,{children:"Die Diagnoseanfrage und -antwort basiert auf standardisierten Diensten, die im UDS-Protokoll (Unified Diagnostic Services, ISO 14229) definiert sind. Hier sind einige der h\xe4ufig verwendeten Dienste:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Datenabruf (Read Data by Identifier, SID: 0x22)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Zweck: Abrufen von Sensordaten, Softwareversionen oder Fahrzeugstatusinformationen."}),"\n",(0,s.jsx)(n.li,{children:"Beispiel: Abrufen der Fahrgestellnummer (VIN)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Fehlercode-Auslese (Read DTCs, SID: 0x19)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Zweck: Abrufen von Diagnose-Fehlercodes (DTCs) aus einer ECU."}),"\n",(0,s.jsx)(n.li,{children:"Beispiel: Anfordern aller gespeicherten DTCs."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Steuerger\xe4te-Reset (ECU Reset, SID: 0x11)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Zweck: Zur\xfccksetzen eines Steuerger\xe4ts, z. B. nach einem Softwareupdate."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Datenprogrammierung (Write Data by Identifier, SID: 0x2E)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Zweck: Schreiben neuer Daten in eine ECU, z. B. Kalibrierungswerte."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ablaufdiagramm-einer-diagnoseanfrage-und--antwort",children:"Ablaufdiagramm einer Diagnoseanfrage und -antwort"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Diagnosetester (Tester)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stellt eine Anfrage mit spezifischen Daten (SID und DID)."}),"\n",(0,s.jsx)(n.li,{children:"Sendet die Anfrage \xfcber TCP/IP an das Gateway."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Gateway"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Leitet die Anfrage an die Ziel-ECU weiter."}),"\n",(0,s.jsx)(n.li,{children:"Empf\xe4ngt die Antwort von der ECU."}),"\n",(0,s.jsx)(n.li,{children:"Sendet die Antwort zur\xfcck an den Tester."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"ECU (Steuerger\xe4t)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Verarbeitet die Anfrage."}),"\n",(0,s.jsx)(n.li,{children:"Stellt die angeforderten Daten bereit oder f\xfchrt den angeforderten Befehl aus."}),"\n",(0,s.jsx)(n.li,{children:"Sendet eine Antwort mit den Ergebnissen zur\xfcck."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"relevante-codebeispiele",children:"Relevante Codebeispiele"}),"\n",(0,s.jsx)(n.h3,{id:"beispiel-1-senden-einer-diagnoseanfrage",children:"Beispiel 1: Senden einer Diagnoseanfrage"}),"\n",(0,s.jsx)(n.p,{children:"Das folgende Python-Skript zeigt, wie eine Diagnoseanfrage \xfcber TCP an ein Gateway gesendet wird:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import socket\n\n# Verbindungsparameter\ntester_ip = "192.168.1.1"\ngateway_ip = "192.168.1.2"\ntester_port = 18945  # Zuf\xe4llig generierter Port\ngateway_port = 13400  # Zielport f\xfcr DoIP\n\n# Diagnoseanfrage erstellen (SID: 0x22, DID: 0x1234)\ndiagnostic_request = bytearray([0x22, 0x12, 0x34])\n\n# Verbindung herstellen und Anfrage senden\nwith socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:\n    s.connect((gateway_ip, gateway_port))\n    s.send(diagnostic_request)\n    response = s.recv(1024)\n\nprint("Diagnoseantwort erhalten:", response.hex())\n'})}),"\n",(0,s.jsx)(n.h3,{id:"beispiel-2-auswerten-einer-diagnoseantwort",children:"Beispiel 2: Auswerten einer Diagnoseantwort"}),"\n",(0,s.jsx)(n.p,{children:"Das folgende Skript zeigt, wie eine Diagnoseantwort analysiert werden kann:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def parse_diagnostic_response(response):\n    sid = response[0]  # Service Identifier\n    data = response[1:]  # Antwortdaten\n    \n    if sid == 0x62:  # Positive Response Code f\xfcr Read Data by Identifier\n        print("Diagnose erfolgreich!")\n        print("Erhaltene Daten:", data.hex())\n    else:\n        print("Fehlercode erhalten:", hex(sid))\n\n# Beispielantwort\nresponse = bytearray([0x62, 0x56, 0x78])\nparse_diagnostic_response(response)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"h\xe4ufige-probleme-und-l\xf6sungen",children:"H\xe4ufige Probleme und L\xf6sungen"}),"\n",(0,s.jsx)(n.h3,{id:"problem-1-keine-antwort-vom-gateway",children:"Problem 1: Keine Antwort vom Gateway"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ursache"}),": Falsche Zieladresse oder Gateway nicht erreichbar."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"L\xf6sung"}),": Pr\xfcfen Sie die Netzwerkverbindung und die IP-Konfiguration."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"problem-2-fehlercode-in-der-antwort",children:"Problem 2: Fehlercode in der Antwort"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ursache"}),": Die ECU hat die Anfrage abgelehnt (z. B. wegen falscher Sicherheitsstufe)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"L\xf6sung"}),": Stellen Sie sicher, dass die Sicherheitsstufe korrekt ist und die Anfrage zul\xe4ssig ist."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"problem-3-zeit\xfcberschreitung",children:"Problem 3: Zeit\xfcberschreitung"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Ursache"}),": Die ECU reagiert nicht rechtzeitig."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"L\xf6sung"}),": Erh\xf6hen Sie den Timeout-Wert oder \xfcberpr\xfcfen Sie die ECU auf Fehler."]}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var r=i(96540);const s={},t=r.createContext(s);function a(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);