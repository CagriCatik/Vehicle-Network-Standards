"use strict";(self.webpackChunkvns=self.webpackChunkvns||[]).push([[82032],{95354:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"SecOC/asymmetric_keypair_management","title":"Asymmetric Keypair Management","description":"Asymmetric cryptography, supported by AUTOSAR SecOC with modifications, uses public/private keypairs to secure in-vehicle communication. Unlike symmetric approaches that rely on a single shared secret, each sender holds a private key to sign outgoing messages, while receivers use the corresponding public key to verify message authenticity. Although more computationally expensive, asymmetric schemes add flexibility and robust security\u2014compromise of one ECU\u2019s private key does not affect others. Below is a comprehensive overview of keypair generation, distribution, and revocation as typically managed in an automotive environment via a Key Management Server (KMS).","source":"@site/docs/SecOC/06_asymmetric_keypair_management.md","sourceDirName":"SecOC","slug":"/SecOC/asymmetric_keypair_management","permalink":"/Vehicle-Network-Standards/docs/SecOC/asymmetric_keypair_management","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/SecOC/06_asymmetric_keypair_management.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"secocSidebar","previous":{"title":"Symmetric Secret Key Management","permalink":"/Vehicle-Network-Standards/docs/SecOC/symmetric_key_management"}}');var r=i(74848),t=i(28453);const a={},c="Asymmetric Keypair Management",o={},l=[{value:"Keypair Basics",id:"keypair-basics",level:2},{value:"Generating Keypairs",id:"generating-keypairs",level:2},{value:"Distribution of Public Keys",id:"distribution-of-public-keys",level:2},{value:"Revoking and Updating Keypairs",id:"revoking-and-updating-keypairs",level:2},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"asymmetric-keypair-management",children:"Asymmetric Keypair Management"})}),"\n",(0,r.jsxs)(n.p,{children:["Asymmetric cryptography, supported by AUTOSAR SecOC with modifications, uses ",(0,r.jsx)(n.strong,{children:"public/private keypairs"})," to secure in-vehicle communication. Unlike symmetric approaches that rely on a single shared secret, each sender holds a private key to sign outgoing messages, while receivers use the corresponding public key to verify message authenticity. Although more computationally expensive, asymmetric schemes add flexibility and robust security\u2014compromise of one ECU\u2019s private key does not affect others. Below is a comprehensive overview of keypair generation, distribution, and revocation as typically managed in an automotive environment via a Key Management Server (KMS)."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"keypair-basics",children:"Keypair Basics"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Public/Private Key Roles"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Private Key"}),": Held securely by the sending ECU. Used to generate digital signatures, analogous to a MAC in symmetric systems."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Public Key"}),": Distributed to and trusted by receiving ECUs. Used to verify signatures."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SecOC Adaptations"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"While SecOC primarily focuses on MAC-based authentication (using symmetric keys), it can be modified to handle asymmetric signatures."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No Truncated Signatures"}),": Unlike truncated MACs for bandwidth efficiency, asymmetric signatures generally must be transmitted in full."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Security and Efficiency Trade-Off"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Benefits"}),": High compromise isolation (one private key breach does not affect all ECUs) and easier revocation/rotation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Drawbacks"}),": Higher processing overhead; might be unsuitable for high-frequency signals on bandwidth-limited buses."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"generating-keypairs",children:"Generating Keypairs"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"ECU-Based Key Generation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Each ECU generates its own keypair (e.g., ECC or RSA) using the Crypto Service Manager (CSM) and secure hardware modules."}),"\n",(0,r.jsx)(n.li,{children:"This approach prevents centralized storage of private keys, minimizing single points of failure."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Management Server (KMS) as Certificate Authority"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Once an ECU generates a public key, it sends it to the KMS for signing."}),"\n",(0,r.jsx)(n.li,{children:"The KMS acts like a local Certificate Authority (CA), issuing a signature that validates the authenticity of the ECU\u2019s public key."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Default Keypair"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"In production, ECUs may ship with a presigned default keypair. The system can later replace or update this default pair once the vehicle is operational."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example (Pseudocode)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-c",children:"// Example: Keypair Generation via CSM\n\nbool generateKeypair(uint16_t ecuId, KeyPair *kpOut) {\n    // Request key generation from Crypto Service Manager\n    bool success = CSM_GenerateAsymmetricKey(\n        ALGO_ECC_SECP256R1,  // Example curve\n        kpOut-privateKey,\n        kpOut-publicKey\n    );\n    if(!success) {\n        return false;\n    }\n\n    // (Optional) Submit the new public key to KMS for signing\n    success = KMS_RequestPublicKeySigning(ecuId, kpOut-publicKey, kpOut-publicKeySignature);\n    return success;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["In this snippet, the ECU calls the ",(0,r.jsx)(n.strong,{children:"CSM_GenerateAsymmetricKey"})," function to produce an ECC keypair. It then forwards the public key to the KMS, which returns a signature or certificate attesting to the key\u2019s legitimacy."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"distribution-of-public-keys",children:"Distribution of Public Keys"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"KMS Broadcast"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"After signing the ECU\u2019s public key, the KMS broadcasts this certified key to all other ECUs."}),"\n",(0,r.jsx)(n.li,{children:"Each ECU maintains a \u201cwhitelist\u201d or \u201ctrusted store\u201d of known, signed public keys."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Activation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Once an ECU\u2019s public key is accepted and stored by others, the ECU can begin transmitting signed messages."}),"\n",(0,r.jsx)(n.li,{children:"Receivers verify signatures by referencing the stored public key in their local whitelist."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Certificate or Key Storage"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Public keys (and their signatures) are stored in non-volatile memory or dedicated secure storage, preventing loss of trust across reboots."}),"\n",(0,r.jsx)(n.li,{children:"If the system supports X.509 certificates, each ECU might hold a small certificate chain."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"revoking-and-updating-keypairs",children:"Revoking and Updating Keypairs"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Revocation Broadcast"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"If a private key is compromised or an ECU is deemed rogue, the KMS issues a revocation message (or \u201cblacklist\u201d) for that ECU\u2019s public key."}),"\n",(0,r.jsx)(n.li,{children:"All ECUs remove or mark the compromised key as invalid to prevent future verifications."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Keypair Regeneration"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The affected ECU generates a new keypair using the Crypto Service Manager."}),"\n",(0,r.jsx)(n.li,{children:"The KMS signs the new public key and broadcasts it, restoring secure communication for that ECU."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Efficient Isolation"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Only the compromised ECU needs a key refresh. Other ECUs remain unaffected, illustrating the compromise isolation advantage of asymmetric crypto."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Example (Pseudocode)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-c",children:"// Example: Revocation Flow\n\nbool revokePublicKey(uint8_t *compromisedPublicKey, size_t keyLen) {\n    // KMS compiles a blacklist or revocation list\n    RevocationMsg revMsg;\n    memcpy(revMsg.key, compromisedPublicKey, keyLen);\n\n    // Broadcast to all ECUs\n    broadcastRevocationMessage(&revMsg);\n\n    // On each ECU:\n    // if( memcmp(localKeyStore[i].publicKey, revMsg.key, keyLen) == 0 ) {\n    //     localKeyStore[i].status = KEY_REVOKED;\n    // }\n    return true;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"In this scenario, each ECU compares the revoked key against its local store. If it finds a match, that key is immediately deactivated."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Asymmetric Keypair Management"})," in an automotive SecOC environment involves:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Key Generation"}),": Each ECU creating its own public/private keypair, typically via hardware-backed cryptographic modules and the CSM."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Certification"}),": The KMS (acting as a local CA) signs the public key to verify authenticity."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Distribution"}),": All ECUs receive the signed public keys, updating whitelists or trust stores to recognize valid peers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Revocation"}),": Compromised or outdated public keys can be instantly revoked by a KMS broadcast."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Security vs. Performance"}),": While more secure and granular in key revocation, asymmetric methods incur higher computational costs and do not support truncated signatures."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"By adopting these best practices, automotive systems benefit from robust authentication, granular compromise isolation, and clear upgrade paths, further enhancing the security posture of in-vehicle communication."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>c});var s=i(96540);const r={},t=s.createContext(r);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);